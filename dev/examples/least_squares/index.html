<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Least squares · RadialCalderon.jl</title><meta name="title" content="Least squares · RadialCalderon.jl"/><meta property="og:title" content="Least squares · RadialCalderon.jl"/><meta property="twitter:title" content="Least squares · RadialCalderon.jl"/><meta name="description" content="Documentation for RadialCalderon.jl."/><meta property="og:description" content="Documentation for RadialCalderon.jl."/><meta property="twitter:description" content="Documentation for RadialCalderon.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">RadialCalderon.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../forward/">Forward map</a></li><li><a class="tocitem" href="../nonlinear_sdp/">Convex nonlinear SDP</a></li><li class="is-active"><a class="tocitem" href>Least squares</a><ul class="internal"><li><a class="tocitem" href="#Setting"><span>Setting</span></a></li><li><a class="tocitem" href="#Using-[NonlinearSolve.jl](https://github.com/SciML/NonlinearSolve.jl)"><span>Using NonlinearSolve.jl</span></a></li><li><a class="tocitem" href="#Using-[Optimization.jl](https://github.com/SciML/Optimization.jl)"><span>Using Optimization.jl</span></a></li></ul></li></ul></li><li><span class="tocitem">Experiments</span><ul><li><a class="tocitem" href="../../experiments/ill_posedness/">Ill-posedness</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../ref/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Least squares</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Least squares</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/rpetit/RadialCalderon.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/rpetit/RadialCalderon.jl/blob/main/examples/least_squares.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reconstruction-via-nonlinear-least-squares"><a class="docs-heading-anchor" href="#Reconstruction-via-nonlinear-least-squares">Reconstruction via nonlinear least squares</a><a id="Reconstruction-via-nonlinear-least-squares-1"></a><a class="docs-heading-anchor-permalink" href="#Reconstruction-via-nonlinear-least-squares" title="Permalink"></a></h1><p>In this tutorial, we show how to implement the least squares approach to solve the Calderón problem in the noiseless setting. To be more precise, we wish to minimize the functional</p><p class="math-container">\[f:\sigma\mapsto \frac{1}{2}\|\Lambda(\sigma)-\Lambda(\sigma^\dagger)\|_2^2\]</p><p>where <span>$\sigma^\dagger$</span> is an unknown conductivity. Since <span>$\Lambda$</span> is nonlinear, <span>$f$</span> is non-convex and iterative minimization algorithms could in principle suffer from the problem of local convergence (their output might heavily depend on their initialization). However, we will see that, in practice, the main issue is rather the ill-posedness of the inverse problem, and that robust iterative algorithms almost always converge to a global minmizer regardless of their initialization.</p><h2 id="Setting"><a class="docs-heading-anchor" href="#Setting">Setting</a><a id="Setting-1"></a><a class="docs-heading-anchor-permalink" href="#Setting" title="Permalink"></a></h2><pre><code class="language-julia hljs">using RadialCalderon

n = 3
r = [0.5, 0.25]
forward = ForwardProblem(r)

m = n
Λ(σ) = [forward_map(forward, j, σ) for j in 1:m]  # forward map

a = 0.5
b = 1.5

σ_true = [0.8, 1.2, 1.0]  # unknown conductivity
obs_true = Λ(σ_true);  # observations</code></pre><h2 id="Using-[NonlinearSolve.jl](https://github.com/SciML/NonlinearSolve.jl)"><a class="docs-heading-anchor" href="#Using-[NonlinearSolve.jl](https://github.com/SciML/NonlinearSolve.jl)">Using <a href="https://github.com/SciML/NonlinearSolve.jl">NonlinearSolve.jl</a></a><a id="Using-[NonlinearSolve.jl](https://github.com/SciML/NonlinearSolve.jl)-1"></a><a class="docs-heading-anchor-permalink" href="#Using-[NonlinearSolve.jl](https://github.com/SciML/NonlinearSolve.jl)" title="Permalink"></a></h2><p>We use the package <a href="https://github.com/SciML/NonlinearSolve.jl">NonlinearSolve.jl</a> to solve the equation <span>$\Lambda(\sigma)=\Lambda(\sigma^\dagger)$</span> using a robust Newton-type algorithm initialized with a guess <span>$\sigma_{\mathrm{init}}$</span>. We notice that, in practice, the method converges to a solution regardless of its initialization.</p><pre><code class="language-julia hljs">using Base.Iterators: product

k = 5
prod_it = product([range(a, b, k) for i=1:3]...)
σ_init_tab = hcat(collect.(collect(prod_it))...)
nσ_init = size(σ_init_tab, 2)

@info &quot;Number of initializations: $nσ_init&quot;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Number of initializations: 125</code></pre><p>The set of initial guesses is a regular discretization of <span>$[a,b]^n$</span> using <span>$k^n$</span> points (here, we chose <span>$k=5$</span>).</p><pre><code class="language-julia hljs">using NonlinearSolve

residual(σ, p) = Λ(σ) .- obs_true
max_linf_err = 0.0
max_linf_err_obs = 0.0

for i=1:nσ_init
    σ_init = σ_init_tab[:, i]
    problem = NonlinearProblem(residual, σ_init)
    res = NonlinearSolve.solve(problem, RobustMultiNewton(), abstol=1e-15)
    σ_hat = res.u
    global max_linf_err = max(max_linf_err, maximum(abs.(σ_hat .- σ_true)))
    global max_linf_err_obs = max(max_linf_err_obs, maximum(abs.(Λ(σ_hat) .- obs_true)))
end

@info &quot;Maximum l-infinity error (conductivity): $max_linf_err&quot;
@info &quot;Maximum l-infinity error (observations): $max_linf_err_obs&quot;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Maximum l-infinity error (conductivity): 4.529709940470639e-14
[ Info: Maximum l-infinity error (observations): 6.661338147750939e-16</code></pre><h2 id="Using-[Optimization.jl](https://github.com/SciML/Optimization.jl)"><a class="docs-heading-anchor" href="#Using-[Optimization.jl](https://github.com/SciML/Optimization.jl)">Using <a href="https://github.com/SciML/Optimization.jl">Optimization.jl</a></a><a id="Using-[Optimization.jl](https://github.com/SciML/Optimization.jl)-1"></a><a class="docs-heading-anchor-permalink" href="#Using-[Optimization.jl](https://github.com/SciML/Optimization.jl)" title="Permalink"></a></h2><p>We can also use the <a href="https://github.com/SciML/Optimization.jl">Optimization.jl</a> package to call a large list of optimization algorithms to minimize <span>$f$</span>. Here, we use an interior point Newton algorithm from the <a href="https://github.com/JuliaNLSolvers/Optim.jl">Optim.jl</a> package. We enforce the constraint <span>$\sigma_i&gt;10^{-5}$</span> to avoid domain errors.</p><pre><code class="language-julia hljs">using Optimization
using OptimizationOptimJL
using DifferentiationInterface
import ForwardDiff

obj(σ, p) = 0.5 * sum((Λ(σ) .- obs_true).^2)
optfun = OptimizationFunction(obj, SecondOrder(AutoForwardDiff(), AutoForwardDiff()))

max_linf_err = 0.0
max_linf_err_obs = 0.0

for i=1:nσ_init
    σ_init = σ_init_tab[:, i]
    problem = OptimizationProblem(optfun, σ_init, lb=1e-5.*ones(n), ub=Inf.*ones(n))
    res = solve(problem, IPNewton(), g_tol=1e-17)
    σ_hat = res.u
    global max_linf_err = max(max_linf_err, maximum(abs.(σ_hat .- σ_true)))
    global max_linf_err_obs = max(max_linf_err_obs, maximum(abs.(Λ(σ_hat) .- obs_true)))
end

@info &quot;Maximum l-infinity error (conductivity): $max_linf_err&quot;
@info &quot;Maximum l-infinity error (observations): $max_linf_err_obs&quot;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Maximum l-infinity error (conductivity): 3.6703973194107675e-13
[ Info: Maximum l-infinity error (observations): 1.1102230246251565e-15</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../nonlinear_sdp/">« Convex nonlinear SDP</a><a class="docs-footer-nextpage" href="../../experiments/ill_posedness/">Ill-posedness »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Friday 13 June 2025 13:59">Friday 13 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
